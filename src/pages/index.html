<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"/>
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <link type="text/css" rel="stylesheet" href="css/jquery.mobile-1.4.5.css"/>
  <link type="text/css" rel="stylesheet" href="css/photoswipe.css"/>
  <link type="text/css" rel="stylesheet" href="css/app.css"/>
  <script src="scripts/libs.js"></script>
  <script src="scripts/app.js"></script>


  <!--#############
      Welcome Page
      #############-->
  <script type="text/template" id="welcome-page-template">
    <div data-role="content">
      <center><h1>Rare Arable Plants</h1></center>
      <br/>
      <a href="#list" data-role="button">Plant Guide</a>
      <br/>
      <center><h3>Logos go here</h3></center>
    </div>
  </script>

  <!--#############
      List Page
      #############-->
  <script type="text/template" id="list-page-template">
    <div data-role="header" id="list-header" data-position="fixed"
         data-tap-toggle="false">
      <div class='ui-btn-left' data-role='controlgroup' data-type='horizontal'>
        <a href='#' data-rel='back' data-role="button" data-icon="arrow-l"
           data-iconpos="notext">Back</a>
      </div>

      <h1 id='list_heading'></h1>

      <div class='ui-btn-right' data-role='controlgroup' data-type='horizontal'>
        <a href="#" id="fav-button" data-role="button"
           onclick="app.controller.list.filterFavourites()"
           data-icon="star" data-iconpos="notext">Favourie</a>
        <a href="#" id="list-controls-button" data-role="button"
           data-icon="bullets" data-iconpos="notext">List Controls</a>
      </div>
      <div id="list-controls-placeholder">
        <div data-role="tabs" id="list-controls-tabs">
          <div data-role="navbar">
            <ul>
              <li><a href="#filter" data-ajax="false"
                     class="ui-btn-active">Filter</a></li>
              <li><a href="#sort" data-ajax="false">Sort</a></li>
            </ul>
          </div>
          <div id="sort" class="ui-body-d ui-content">
            <div class="info-message">
              <p>Please select the list sorting.</p>
            </div>
            <div id="list-controls-sort-placeholder"></div>
          </div>
          <div id="filter" class="ui-body-d ui-content">
            <div class="info-message">
              <p>Please check filters to apply. </p>
            </div>
            <div id="list-controls-filter-placeholder"></div>
          </div>
          <center>
            <button id="list-controls-save-button">Save</button>
          </center>
        </div>
      </div>
    </div>
    <div data-role="content">
      <div id="list-placeholder"></div>
    </div>
  </script>

  <script id="list-controls-sort-template" type="text/x-handlebars-template">
    <div class="ui-field-contain list-controls">
      <fieldset data-role="controlgroup">
        {{#each this}}
        <input name="sort" type="radio" id="{{id}}" class="sort" {{checked}}
               data-iconpos="right">
        <label for="{{id}}" class="sort">{{label}}</label>
        {{/each}}
      </fieldset>
    </div>
  </script>

  <script id="list-template" type="text/x-handlebars-template">
    <ul data-role="listview" data-split-icon="gear" data-split-theme="d">
      {{#each species}}
      <li data-corners="false" data-shadow="false" data-iconshadow="true"
          data-wrapperels="div" data-icon="arrow-r" data-iconpos="right"
          data-theme="c">
        <a href="#species"
           onclick="app.controller.list.setCurrentSpecies('{{id}}')"
           class="{{favourite}}">
          <img src="{{profile_pic}}"/>

          <p class="species-list-common-name">{{common_name}}</p>

          <p>{{taxon}}</p>
        </a>
        <a href="#record" class="ios-enhanced"
           onclick="app.controller.list.setCurrentSpecies('{{id}}')"
           data-icon="plus">Record</a>
      </li>
      {{/each}}
    </ul>
  </script>

  <script id="list-controls-filter-template" type="text/x-handlebars-template">
    <div class="ui-field-contain list-controls">
      <fieldset data-role="controlgroup">
        {{#each this}}
        <input type="checkbox" id="{{id}}" class="filter" {{checked}}
               data-iconpos="right">
        <label for="{{id}}" class="filter">{{label}}</label>
        {{/each}}
      </fieldset>
    </div>
  </script>

  <!-- Species -->
  <script type="text/template" id="species-page-template">
    <div data-role="header" data-position="fixed" data-tap-toggle="false">
      <div class='ui-btn-left' data-role='controlgroup' data-type='horizontal'>
        <a href='#' data-rel='back' data-role="button" data-icon="arrow-l"
           data-iconpos="notext">Back</a>
      </div>
      <h1 id='species_heading'></h1>

      <div class="ui-btn-right" data-role="controlgroup" data-type="horizontal">
        <a href="#" id="species-profile-fav-button"
           onclick="app.controller.species.toggleSpeciesFavourite()"
           data-icon="star" data-iconpos="notext" data-role="button">Gallery</a>
      </div>
    </div>

    <div data-role="content">
      <div id="species-placeholder"></div>

    </div>
  </script>
  <script id="species-template" type="text/x-handlebars-template">
    <center>
      <div class="gallery" id="species_gallery">
        <a href="{{profile_pic}}">
          <img src="{{profile_pic}}">
        </a>
      </div>

      {{#if map}}
      <button id="species-map-button">Show Distribution</button>

      <svg id="species-map" preserveAspectRatio="none" style="display:none"
           xmlns="http://www.w3.org/2000/svg"
           xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
        <use id="species-map-data" xlink:href="{{map}}#data"/>
        <use id="species-map-boundary"
             xlink:href="{{national_boundary}}#boundary"/>
      </svg>
      {{/if}}

      <ul data-role="listview" data-inset="true" style="max-width:800px;">
        <li>
          <div class="taxon">{{taxon}}</div>
        </li>
        <li>
          <p>{{{description}}}</p>
        </li>
      </ul>
    </center>
  </script>
  <!--#############
      Record Page
      #############-->
  <script type="text/template" id="record-page-template">
    <div data-role="header" data-position="fixed" data-tap-toggle="false">
      <div class='ui-btn-left' data-role='controlgroup' data-type='horizontal'>
        <a href='#' data-rel='back' data-role="button" data-icon="arrow-l"
           data-iconpos="notext">Back</a>
      </div>
      <h1 id='record_heading'></h1>

      <div class='ui-btn-right' data-role='controlgroup' data-type='horizontal'>
        <a href="#date" id="date-top-button" data-role="button"
           data-icon="calendar" data-iconpos="notext">Date</a>
        <a href="#sref" id="sref-top-button" data-role="button" class="none"
           data-icon="location" data-iconpos="notext">GPS</a>
      </div>
    </div>
    <div data-role="content">
      <input type="hidden" id="occurrence:record_status"
             name="occurrence:record_status" value="C"/>
      <a href="#date" id="date-button" data-role="button" data-icon="arrow-r"
         data-iconpos="right">
        <h1>Date</h1>
      </a><input type="hidden" id="imp-sref" name="sample:entered_sref" required/>
      <input type="hidden" id="imp-sref-system" name="sample:entered_sref_system"
             value="4326"/>
      <input type="hidden" id="sref_accuracy" name="smpAttr:273" value="-1"/>

      <div id="photo">
        <div id="photo-picker">
          <input type="file" id="sample:image" name="sample:image"
                 accept="png|jpg|gif|jpeg"/>
          <input type="hidden" id="sample_medium:path" name="sample_medium:path"
                 value=""/>
        </div>
      </div>
      <a href="#number" id="number-button" class="record-button"
         data-role="button"
         data-icon="arrow-r" data-iconpos="right"> Number </a>
      <a href="#stage" id="stage-button" class="record-button" data-role="button"
         data-icon="arrow-r" data-iconpos="right"> Life Stage </a>
      <a href="#comment" id="comment-button" class="record-button"
         data-role="button"
         data-icon="arrow-r" data-iconpos="right"> Comment </a>
    </div>
    <div data-role="footer" data-position="fixed" data-tap-toggle="false">
      <div class='ui-btn-left' data-role='controlgroup' data-type='horizontal'>
        <input id="entry-form-save" type="button" value="Save" data-icon="plus"
               onclick="app.controller.record.save()" data-theme="b"
               data-iconpos="right">
      </div>
      <h1 id='record_footer'></h1>

      <div class='ui-btn-right' data-role='controlgroup' data-type='horizontal'>
        <input id="entry-form-send" type="button" value="Send" data-icon="mail"
               onclick="app.controller.record.send()" data-theme="b"
               data-iconpos="right">
      </div>

    </div>
  </script>
  <!-- Comment -->
  <script type="text/template" id="comment-page-template">
    <div data-role="header" data-position="fixed" data-tap-toggle="false">
      <div class='ui-btn-left' data-role='controlgroup' data-type='horizontal'>
        <a href='#' data-rel="back" data-role="button" data-iconpos="notext"
           data-icon="delete">Cancel</a>
      </div>
      <h1>Comment</h1>

      <div class='ui-btn-right' data-role='controlgroup' data-type='horizontal'>
        <a href='#' data-rel="back" data-role="button" data-iconpos="notext"
           data-icon="check"
           onclick="app.controller.record.saveInput('sample:comment')">Save</a>
      </div>
    </div>
    <div data-role="content">
    <textarea id="sample:comment" name="sample:comment" class=" " cols="80"
              rows="4"></textarea>
    </div>
    <div data-role="footer" data-position="fixed" data-tap-toggle="false"></div>
  </script>
  <!-- Date -->
  <script type="text/template" id="date-page-template">
    <div data-role="header" data-position="fixed" data-tap-toggle="false">
      <div class='ui-btn-left' data-role='controlgroup' data-type='horizontal'>
        <a href='#' data-rel="back" data-role="button" data-iconpos="notext"
           data-icon="delete">Cancel</a>
      </div>
      <h1>Date</h1>

      <div class='ui-btn-right' data-role='controlgroup' data-type='horizontal'>
        <a href='#' data-rel="back" data-role="button" data-iconpos="notext"
           onclick="app.controller.record.saveInput('sample:date')"
           data-icon="check">Save</a>
      </div>
    </div>
    <div data-role="content">
      <div class="info-message"><p>Please enter the date of the recording.</p>
      </div>
      <input id="sample:date" name="sample:date" type="date" required>
    </div>
  </script>

  <!--#############
      Location Page
      #############-->
  <script type="text/template" id="sref-page-template">
    <div data-role="header" data-position="fixed" data-tap-toggle="false">
      <div class='ui-btn-left' data-role='controlgroup' data-type='horizontal'>
        <a href='#' data-rel="back" data-role="button" data-iconpos="notext"
           data-icon="delete">Cancel</a>
      </div>
      <h1>Location</h1>

      <div class='ui-btn-right' data-role='controlgroup' data-type='horizontal'>
        <a href='#' data-rel="back" data-role="button" data-iconpos="notext"
           data-icon="check" onclick="app.controller.sref.save()">Save</a>
      </div>
    </div>
    <div data-role="content">
      <div data-role="tabs" id="sref-opts">
        <div data-role="navbar">
          <ul>
            <li><a href="#gps" data-ajax="false" class="ui-btn-active">GPS</a>
            </li>
            <li><a href="#map" data-ajax="false">Map</a></li>
            <li><a href="#gref" data-ajax="false">Grid Ref</a></li>
          </ul>
        </div>
        <div id="gps" class="ui-body-d ui-content">

          <div id="sref-gps-placeholder"></div>
        </div>
        <div id="map" class="ui-body-d ui-content">
          <div class="info-message" id="map-message">
            <p>Please tap on the map to select your location. </p>
          </div>
          <div id="map-canvas" style="width:100%; height: 60vh;"></div>
        </div>
        <div id="gref" class="ui-body-d ui-content">
          <div class="info-message" id="gref-message">
            <p>Please provide a GB Grid Reference.
              <br/> e.g. <i>"TQ 28170 77103"</i></p>
          </div>
          <input type="text" id="grid-ref" placeholder="Grid Reference"/>
          <input type="button" onclick="app.controller.sref.gridRefConvert()"
                 value="Set"/>
        </div>
      </div>
    </div>
  </script>

  <!--#############
      User Page
      #############-->
  <script type="text/template" id="user-page-template">
    <div data-role="header" data-position="fixed" data-tap-toggle="false">
      <div class='ui-btn-left' data-role='controlgroup' data-type='horizontal'>
        <a href='#' data-rel='back' data-role="button" data-icon="arrow-l"
           data-iconpos="notext">Back</a>
      </div>
      <h1 id='user_heading'></h1>

      <div class='ui-btn-right' data-role='controlgroup' data-type='horizontal'>
        <a href="#sref" data-role="button" data-icon="location"
           data-iconpos="notext">Set your location</a>
      </div>
    </div>

    <div data-role="content">
      <div id="user-placeholder"></div>
      <div id="saved-list-placeholder"></div>
    </div>
  </script>

  <script id="user-template" type="text/x-handlebars-template">
    {{#if user.loggedout}}
    <div class="warning-message">Looks like you have not Signed in yet. Please
      do so, as otherwise all the records will be submitted anonymously.
      <a href='login' data-role="button" data-icon="arrow-r" data-iconpos="user">Log
        in</a>
    </div>
    {{else}}
    <a href='#' id="logout-button" data-role="button" data-icon="user"
       data-theme="b" onclick="app.controller.login.logout()">Log out</a>
    {{/if}}
  </script>

  <script id="saved-list-template" type="text/x-handlebars-template">
    {{#if records.length}}
    <div class="info-message">Saved recordings.</div>

    <ul data-role="listview" id="saved-list" data-split-icon="gear"
        data-inset="true" data-split-theme="d">
      <li data-corners="false" data-shadow="false" data-iconshadow="true"
          data-wrapperels="div" data-icon="arrow-r" data-iconpos="right"
          data-theme="b">
        <a href="#" id="sendall-button" data-role="button"
           onclick="app.controller.user.sendAllSavedRecords()">
          <center>Send All</center>
        </a>
      </li>
      {{#each records}}
      <li data-corners="false" data-shadow="false" data-iconshadow="true"
          data-wrapperels="div" data-icon="arrow-r" data-iconpos="right">
        <a href="#" onclick="app.controller.user.sendSavedRecord({{id}})">
          <!--<img src="" />-->
          <h3>{{common_name}}</h3>

          <p>{{date}}</p>
        </a>
        <a href="#" data-icon="delete" data-ajax="false"
           onclick="app.controller.user.deleteSavedRecord({{id}})">Send</a>
      </li>
      {{/each}}
    </ul>
    {{else}}
    <div class="info-message">No saved recordings.</div>
    {{/if}}
  </script>
  <script id="sref-gps" type="text/x-handlebars-template">
    <div class="info-message">
      <p>We will try to determine your location
        using the inbuilt phone GPS.</p>

      <p> Please make sure you have turned the phone's
        geolocation on and are well away from large objects.<br/> e.g. <i>trees,
          buildings </i></p>
    </div>
    {{#if location}}
    <div class="success-message">
      <p> Grid Ref: {{location.gref}} <br/><br/>
        Lat: {{location.lat}} <br/>
        Lon: {{location.lon}} <br/><br/>
        Accuracy: {{location.acc}} meters
      </p>
    </div>
    <input type="button" id="gps-improve-button" value="Improve">
    {{else}}
    <input type="button" id="gps-start-button" value="Locate">
    {{/if}}
  </script>
  <script id="sref-gps-running" type="text/x-handlebars-template">
    <div class="info-message">
      <p>We are trying to get your location. This might take a
        few minutes...</p>
    </div>
    {{#if location}}
    <div class="success-message">
      <p> Grid Ref: {{location.gref}} <br/><br/>
        Lat: {{location.lat}} <br/>
        Lon: {{location.lon}} <br/><br/>
        Accuracy: {{location.acc}} meters
      </p>
    </div>
    {{/if}}

    <input type="button" id="gps-stop-button" value="Stop">
  </script>
  <script id="sref-gps-finished" type="text/x-handlebars-template">
    <div class="success-message">
      <p>Success!</p>

      <p> Grid Ref: {{location.gref}} <br/><br/>
        Lat: {{location.lat}} <br/>
        Lon: {{location.lon}} <br/><br/>
        Accuracy: {{location.acc}} meters
      </p>
    </div>
    <input type="button" id="gps-improve-button" value="Improve">
  </script>
</head>
<body>

</body>
</html>